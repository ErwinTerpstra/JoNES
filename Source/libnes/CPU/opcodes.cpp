#include "cpu.h"

using namespace libnes;

const CPU::Instruction CPU::INSTRUCTION_MAP[] =
{
	{ 0x00, ADDR_INVALID, "", NULL },
	{ 0x01, ADDR_IZPX,			"ORA", &CPU::ora },
	{ 0x02, ADDR_INVALID, "", NULL },
	{ 0x03, ADDR_INVALID, "", NULL },
	{ 0x04, ADDR_INVALID, "", NULL },
	{ 0x05, ADDR_ZP,			"ORA", &CPU::ora },
	{ 0x06, ADDR_ZP,			"ASL", &CPU::asl },
	{ 0x07, ADDR_INVALID, "", NULL },
	{ 0x08, ADDR_INVALID, "", NULL },
	{ 0x09, ADDR_IMM,			"ORA", &CPU::ora },
	{ 0x0A, ADDR_IMPL,			"ASL A", &CPU::asl_a },
	{ 0x0B, ADDR_INVALID, "", NULL },
	{ 0x0C, ADDR_INVALID, "", NULL },
	{ 0x0D, ADDR_ABS,			"ORA", &CPU::ora },
	{ 0x0E, ADDR_ABS,			"ASL", &CPU::asl },
	{ 0x0F, ADDR_INVALID, "", NULL },

	{ 0x10, ADDR_INVALID, "", NULL },
	{ 0x11, ADDR_IZPY,			"ORA", &CPU::ora },
	{ 0x12, ADDR_INVALID, "", NULL },
	{ 0x13, ADDR_INVALID, "", NULL },
	{ 0x14, ADDR_INVALID, "", NULL },
	{ 0x15, ADDR_ZPX,			"ORA", &CPU::ora },
	{ 0x16, ADDR_ZPX,			"ASL", &CPU::asl },
	{ 0x17, ADDR_INVALID, "", NULL },
	{ 0x18, ADDR_INVALID, "", NULL },
	{ 0x19, ADDR_ABSY,			"ORA", &CPU::ora },
	{ 0x1A, ADDR_INVALID, "", NULL },
	{ 0x1B, ADDR_INVALID, "", NULL },
	{ 0x1C, ADDR_INVALID, "", NULL },
	{ 0x1D, ADDR_ABSX,			"ORA", &CPU::ora },
	{ 0x1E, ADDR_ABSX,			"ASL", &CPU::asl },
	{ 0x1F, ADDR_INVALID, "", NULL },

	{ 0x20, ADDR_INVALID, "", NULL },
	{ 0x21, ADDR_IZPX,			"AND", &CPU::anda },
	{ 0x22, ADDR_INVALID, "", NULL },
	{ 0x23, ADDR_INVALID, "", NULL },
	{ 0x24, ADDR_INVALID, "", NULL },
	{ 0x25, ADDR_ZP,			"AND", &CPU::anda },
	{ 0x26, ADDR_ZP,			"ROL", &CPU::rol },
	{ 0x27, ADDR_INVALID, "", NULL },
	{ 0x28, ADDR_INVALID, "", NULL },
	{ 0x29, ADDR_IMM,			"AND", &CPU::anda },
	{ 0x2A, ADDR_IMPL,			"ROL A", &CPU::rol_a },
	{ 0x2B, ADDR_INVALID, "", NULL },
	{ 0x2C, ADDR_INVALID, "", NULL },
	{ 0x2D, ADDR_ABS,			"AND", &CPU::anda },
	{ 0x2E, ADDR_ABS,			"ROL", &CPU::rol },
	{ 0x2F, ADDR_INVALID, "", NULL },

	{ 0x30, ADDR_INVALID, "", NULL },
	{ 0x31, ADDR_IZPY,			"AND", &CPU::anda },
	{ 0x32, ADDR_INVALID, "", NULL },
	{ 0x33, ADDR_INVALID, "", NULL },
	{ 0x34, ADDR_INVALID, "", NULL },
	{ 0x35, ADDR_ZPX,			"AND", &CPU::anda },
	{ 0x36, ADDR_ZPX,			"ROL", &CPU::rol },
	{ 0x37, ADDR_INVALID, "", NULL },
	{ 0x38, ADDR_INVALID, "", NULL },
	{ 0x39, ADDR_ABSY,			"AND", &CPU::anda },
	{ 0x3A, ADDR_INVALID, "", NULL },
	{ 0x3B, ADDR_INVALID, "", NULL },
	{ 0x3C, ADDR_INVALID, "", NULL },
	{ 0x3D, ADDR_ABSX,			"AND", &CPU::anda },
	{ 0x3E, ADDR_ABSX,			"ROL", &CPU::rol },
	{ 0x3F, ADDR_INVALID, "", NULL },

	{ 0x40, ADDR_INVALID, "", NULL },
	{ 0x41, ADDR_IZPX,			"EOR", &CPU::eor },
	{ 0x42, ADDR_INVALID, "", NULL },
	{ 0x43, ADDR_INVALID, "", NULL },
	{ 0x44, ADDR_INVALID, "", NULL },
	{ 0x45, ADDR_ZP,			"EOR", &CPU::eor },
	{ 0x46, ADDR_ZP,			"LSR", &CPU::lsr },
	{ 0x47, ADDR_INVALID, "", NULL },
	{ 0x48, ADDR_INVALID, "", NULL },
	{ 0x49, ADDR_IMM,			"EOR", &CPU::eor },
	{ 0x4A, ADDR_IMPL,			"LSR A", &CPU::lsr_a },
	{ 0x4B, ADDR_INVALID, "", NULL },
	{ 0x4C, ADDR_INVALID, "", NULL },
	{ 0x4D, ADDR_ABS,			"EOR", &CPU::eor },
	{ 0x4E, ADDR_ABS,			"LSR", &CPU::lsr },
	{ 0x4F, ADDR_INVALID, "", NULL },

	{ 0x50, ADDR_INVALID, "", NULL },
	{ 0x51, ADDR_IZPY,			"EOR", &CPU::eor },
	{ 0x52, ADDR_INVALID, "", NULL },
	{ 0x53, ADDR_INVALID, "", NULL },
	{ 0x54, ADDR_INVALID, "", NULL },
	{ 0x55, ADDR_ZPX,			"EOR", &CPU::eor },
	{ 0x56, ADDR_ZPX,			"LSR", &CPU::lsr },
	{ 0x57, ADDR_INVALID, "", NULL },
	{ 0x58, ADDR_INVALID, "", NULL },
	{ 0x59, ADDR_ABSY,			"EOR", &CPU::eor },
	{ 0x5A, ADDR_INVALID, "", NULL },
	{ 0x5B, ADDR_INVALID, "", NULL },
	{ 0x5C, ADDR_INVALID, "", NULL },
	{ 0x5D, ADDR_ABSX,			"EOR", &CPU::eor },
	{ 0x5E, ADDR_ABSX,			"LSR", &CPU::lsr },
	{ 0x5F, ADDR_INVALID, "", NULL },

	{ 0x60, ADDR_INVALID, "", NULL },
	{ 0x61, ADDR_IZPX,			"ADC", &CPU::adc },
	{ 0x62, ADDR_INVALID, "", NULL },
	{ 0x63, ADDR_INVALID, "", NULL },
	{ 0x64, ADDR_INVALID, "", NULL },
	{ 0x65, ADDR_ZP,			"ADC", &CPU::adc },
	{ 0x66, ADDR_ZP,			"ROR", &CPU::ror },
	{ 0x67, ADDR_INVALID, "", NULL },
	{ 0x68, ADDR_INVALID, "", NULL },
	{ 0x69, ADDR_IMM,			"ADC", &CPU::adc },
	{ 0x6A, ADDR_IMPL,			"ROR A", &CPU::ror_a },
	{ 0x6B, ADDR_INVALID, "", NULL },
	{ 0x6C, ADDR_INVALID, "", NULL },
	{ 0x6D, ADDR_ABS,			"ADC", &CPU::adc },
	{ 0x6E, ADDR_ABSX,			"ROR", &CPU::ror },
	{ 0x6F, ADDR_INVALID, "", NULL },

	{ 0x70, ADDR_INVALID, "", NULL },
	{ 0x71, ADDR_IZPY,			"ADC", &CPU::adc },
	{ 0x72, ADDR_INVALID, "", NULL },
	{ 0x73, ADDR_INVALID, "", NULL },
	{ 0x74, ADDR_INVALID, "", NULL },
	{ 0x75, ADDR_ZPX,			"ADC", &CPU::adc },
	{ 0x76, ADDR_ZPX,			"ROR", &CPU::ror },
	{ 0x77, ADDR_INVALID, "", NULL },
	{ 0x78, ADDR_INVALID, "", NULL },
	{ 0x79, ADDR_ABSY,			"ADC", &CPU::adc },
	{ 0x7A, ADDR_INVALID, "", NULL },
	{ 0x7B, ADDR_INVALID, "", NULL },
	{ 0x7C, ADDR_INVALID, "", NULL },
	{ 0x7D, ADDR_ABSX,			"ADC", &CPU::adc },
	{ 0x7E, ADDR_ABSX,			"ROR", &CPU::ror },
	{ 0x7F, ADDR_INVALID, "", NULL },

	{ 0x80, ADDR_INVALID, "", NULL },
	{ 0x81, ADDR_INVALID, "", NULL },
	{ 0x82, ADDR_INVALID, "", NULL },
	{ 0x83, ADDR_INVALID, "", NULL },
	{ 0x84, ADDR_INVALID, "", NULL },
	{ 0x85, ADDR_INVALID, "", NULL },
	{ 0x86, ADDR_INVALID, "", NULL },
	{ 0x87, ADDR_INVALID, "", NULL },
	{ 0x88, ADDR_IMPL,			"DEX", &CPU::dex },
	{ 0x89, ADDR_INVALID, "", NULL },
	{ 0x8A, ADDR_INVALID, "", NULL },
	{ 0x8B, ADDR_INVALID, "", NULL },
	{ 0x8C, ADDR_INVALID, "", NULL },
	{ 0x8D, ADDR_INVALID, "", NULL },
	{ 0x8E, ADDR_INVALID, "", NULL },
	{ 0x8F, ADDR_INVALID, "", NULL },

	{ 0x90, ADDR_INVALID, "", NULL },
	{ 0x91, ADDR_INVALID, "", NULL },
	{ 0x92, ADDR_INVALID, "", NULL },
	{ 0x93, ADDR_INVALID, "", NULL },
	{ 0x94, ADDR_INVALID, "", NULL },
	{ 0x95, ADDR_INVALID, "", NULL },
	{ 0x96, ADDR_INVALID, "", NULL },
	{ 0x97, ADDR_INVALID, "", NULL },
	{ 0x98, ADDR_INVALID, "", NULL },
	{ 0x99, ADDR_INVALID, "", NULL },
	{ 0x9A, ADDR_INVALID, "", NULL },
	{ 0x9B, ADDR_INVALID, "", NULL },
	{ 0x9C, ADDR_INVALID, "", NULL },
	{ 0x9D, ADDR_INVALID, "", NULL },
	{ 0x9E, ADDR_INVALID, "", NULL },
	{ 0x9F, ADDR_INVALID, "", NULL },

	{ 0xA0, ADDR_INVALID, "", NULL },
	{ 0xA1, ADDR_INVALID, "", NULL },
	{ 0xA2, ADDR_INVALID, "", NULL },
	{ 0xA3, ADDR_INVALID, "", NULL },
	{ 0xA4, ADDR_INVALID, "", NULL },
	{ 0xA5, ADDR_INVALID, "", NULL },
	{ 0xA6, ADDR_INVALID, "", NULL },
	{ 0xA7, ADDR_INVALID, "", NULL },
	{ 0xA8, ADDR_INVALID, "", NULL },
	{ 0xA9, ADDR_INVALID, "", NULL },
	{ 0xAA, ADDR_INVALID, "", NULL },
	{ 0xAB, ADDR_INVALID, "", NULL },
	{ 0xAC, ADDR_INVALID, "", NULL },
	{ 0xAD, ADDR_INVALID, "", NULL },
	{ 0xAE, ADDR_INVALID, "", NULL },
	{ 0xAF, ADDR_INVALID, "", NULL },

	{ 0xB0, ADDR_INVALID, "", NULL },
	{ 0xB1, ADDR_INVALID, "", NULL },
	{ 0xB2, ADDR_INVALID, "", NULL },
	{ 0xB3, ADDR_INVALID, "", NULL },
	{ 0xB4, ADDR_INVALID, "", NULL },
	{ 0xB5, ADDR_INVALID, "", NULL },
	{ 0xB6, ADDR_INVALID, "", NULL },
	{ 0xB7, ADDR_INVALID, "", NULL },
	{ 0xA8, ADDR_INVALID, "", NULL },
	{ 0xA9, ADDR_INVALID, "", NULL },
	{ 0xAA, ADDR_INVALID, "", NULL },
	{ 0xAB, ADDR_INVALID, "", NULL },
	{ 0xAC, ADDR_INVALID, "", NULL },
	{ 0xAD, ADDR_INVALID, "", NULL },
	{ 0xAE, ADDR_INVALID, "", NULL },
	{ 0xAF, ADDR_INVALID, "", NULL },

	{ 0xC0, ADDR_IMM,			"CPY", &CPU::cpy },
	{ 0xC1, ADDR_IZPX,			"CMP", &CPU::cmp },
	{ 0xC2, ADDR_INVALID, "", NULL },
	{ 0xC3, ADDR_INVALID, "", NULL },
	{ 0xC4, ADDR_ZP,			"CPY", &CPU::cpy },
	{ 0xC5, ADDR_ZP,			"CMP", &CPU::cmp },
	{ 0xC6, ADDR_ZP,			"DEC", &CPU::dec },
	{ 0xC7, ADDR_INVALID, "", NULL },
	{ 0xC8, ADDR_IMPL,			"INY", &CPU::iny },
	{ 0xC9, ADDR_IMM,			"CMP", &CPU::cmp },
	{ 0xCA, ADDR_IMPL,			"DEX", &CPU::dex },
	{ 0xCB, ADDR_INVALID, "", NULL },
	{ 0xCC, ADDR_ABS,			"CPY", &CPU::cpy },
	{ 0xCD, ADDR_ABS,			"CMP", &CPU::cmp },
	{ 0xCE, ADDR_ABS,			"DEC", &CPU::dec },
	{ 0xCF, ADDR_INVALID, "", NULL },

	{ 0xD0, ADDR_INVALID, "", NULL },
	{ 0xD1, ADDR_IZPY,			"CMP", &CPU::cmp },
	{ 0xD2, ADDR_INVALID, "", NULL },
	{ 0xD3, ADDR_INVALID, "", NULL },
	{ 0xD4, ADDR_INVALID, "", NULL },
	{ 0xD5, ADDR_ZPX,			"CMP", &CPU::cmp },
	{ 0xD6, ADDR_ZPX,			"DEC", &CPU::dec },
	{ 0xD7, ADDR_INVALID, "", NULL },
	{ 0xD8, ADDR_INVALID, "", NULL },
	{ 0xD9, ADDR_ABSY,			"CMP", &CPU::cmp },
	{ 0xDA, ADDR_INVALID, "", NULL },
	{ 0xDB, ADDR_INVALID, "", NULL },
	{ 0xDC, ADDR_INVALID, "", NULL },
	{ 0xDD, ADDR_ABSX,			"CMP", &CPU::cmp },
	{ 0xDE, ADDR_ABSX,			"DEC", &CPU::dec },
	{ 0xDF, ADDR_INVALID, "", NULL },

	{ 0xE0, ADDR_IMM,			"CPX", &CPU::cpx },
	{ 0xE1, ADDR_IZPX,			"SBC", &CPU::sbc },
	{ 0xE2, ADDR_INVALID, "", NULL },
	{ 0xE3, ADDR_INVALID, "", NULL },
	{ 0xE4, ADDR_ZP,			"CPX", &CPU::cpx },
	{ 0xE5, ADDR_ZP,			"SBC", &CPU::sbc },
	{ 0xE6, ADDR_ZP,			"INC", &CPU::inc },
	{ 0xE7, ADDR_INVALID, "", NULL },
	{ 0xE8, ADDR_IMPL,			"INX", &CPU::inx },
	{ 0xE9, ADDR_IMM,			"SBC", &CPU::sbc },
	{ 0xEA, ADDR_INVALID, "", NULL },
	{ 0xEB, ADDR_INVALID, "", NULL },
	{ 0xEC, ADDR_ABS,			"CPX", &CPU::cpx },
	{ 0xED, ADDR_ABS,			"SBC", &CPU::sbc },
	{ 0xEE, ADDR_ABS,			"INC", &CPU::inc },
	{ 0xEF, ADDR_INVALID, "", NULL },

	{ 0xF0, ADDR_INVALID, "", NULL },
	{ 0xF1, ADDR_IZPY,			"SBC", &CPU::sbc},
	{ 0xF2, ADDR_INVALID, "", NULL },
	{ 0xF3, ADDR_INVALID, "", NULL },
	{ 0xF4, ADDR_INVALID, "", NULL },
	{ 0xF5, ADDR_ZPX,			"SBC", &CPU::sbc },
	{ 0xF6, ADDR_ZPX,			"INC", &CPU::inc },
	{ 0xF7, ADDR_INVALID, "", NULL },
	{ 0xF8, ADDR_INVALID, "", NULL },
	{ 0xF9, ADDR_ABSY,			"SBC", &CPU::sbc },
	{ 0xFA, ADDR_INVALID, "", NULL },
	{ 0xFB, ADDR_INVALID, "", NULL },
	{ 0xFC, ADDR_INVALID, "", NULL },
	{ 0xFD, ADDR_ABSX,			"SBC", &CPU::sbc },
	{ 0xFE, ADDR_ABSX,			"INC", &CPU::inc },
	{ 0xFF, ADDR_INVALID, "", NULL },
};